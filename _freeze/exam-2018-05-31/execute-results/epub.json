{
  "hash": "b7a93449936f40a06698874e563bb95a",
  "result": {
    "markdown": "---\ntitle: 2018/05/31<br>Descriptive Statistics and Regression exam\nlang: en\ndate: 2018-05-31\n---\n\n\n\n\n\n\n:::{#exr-1}\n\n\n\n::: {.cell hash='exam-2018-05-31_cache/epub/unnamed-chunk-1_746d68bcd9541e6ebc790a33f9fef2ed'}\n\n```{.r .cell-code}\n## data\noptions(scipen = 999)\nx <- c(51,63,61,44,63,57,53,63,44,59,51,56,58,59,25,30,58,58)\ny <- c(66,71,82,85,72,70,68,74)\nages <- sort(c(x,y))\n\n## questions/answer\nnx <- length(x)\nny <- length(y)\nn <- nx+ny\n# quartiles\nq1 <- quantile(ages,probs = c(0.25), type=1)\nq2 <- quantile(ages,probs = c(0.5), type=1)\nq3 <- quantile(ages,probs = c(0.75), type=1)\n# interquartile range\niqr <- q3-q1\n#fences\nf1 <- q1-1.5*iqr\nf2 <- q3+1.5*iqr\n# outliers\noutliers <- ages[ages<f1 | ages >f2]\n# means\nmx <- mean(x)\nmy <- mean(y)\n# variances\ns2x <- sum(x^2)/nx-mx^2\ns2y <- sum(y^2)/ny-my^2\n# standard deviation\nsx <- sqrt(s2x)\nsy <- sqrt(s2y)\n# coef. variation\ncvx <- sx/mx\ncvy <- sy/my\n# coef. skewness\ng1x <- sum((x-mx)^3)/(nx*sx^3)\ng1y <- sum((y-my)^3)/(ny*sy^3)\n# standard scores\nzx <- (50-mx)/sx\nzy <- (72-my)/sy\n```\n:::\n\n\n\n\nThe ages of a sample of patients of a physical therapy clinic are:\n\n\n\n\n::: {.cell hash='exam-2018-05-31_cache/epub/unnamed-chunk-2_fd565c2e06838ba90c626932d60503b3'}\n\n```{.r .cell-code}\nkable(matrix(ages, ncol = 13, byrow = T)) %>% kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:right;\"> 44 </td>\n   <td style=\"text-align:right;\"> 51 </td>\n   <td style=\"text-align:right;\"> 51 </td>\n   <td style=\"text-align:right;\"> 53 </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 59 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 59 </td>\n   <td style=\"text-align:right;\"> 61 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 63 </td>\n   <td style=\"text-align:right;\"> 66 </td>\n   <td style=\"text-align:right;\"> 68 </td>\n   <td style=\"text-align:right;\"> 70 </td>\n   <td style=\"text-align:right;\"> 71 </td>\n   <td style=\"text-align:right;\"> 72 </td>\n   <td style=\"text-align:right;\"> 74 </td>\n   <td style=\"text-align:right;\"> 82 </td>\n   <td style=\"text-align:right;\"> 85 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\na. Compute the quartiles.\n\na. Draw the box plot and identify outliers (do not group data into intervals).\n\na. Split the sample into two groups, patients younger and older than 65. In which group is the mean more representative. Justify the answer.\n\na. Which distribution is less symmetric, the one of patients younger than 65 or the one of patients older?\n\na. Which age is relatively smaller with respect to its group, 50 years in the group of patients younger than 65 or 72 years in the group of patients older than 65?\n\nUse the following sums for the computations.  \nYounger than 65: $\\sum x_i=953$ years, $\\sum x_i^2=52475$ years$^2$, $\\sum (x_i-\\bar x)^3=-30846.51$ years$^3$ and $\\sum (x_i-\\bar x)^4=939658.83$ years$^4$.  \nOlder than 65: $\\sum x_i=588$ years, $\\sum x_i^2=43530$ years$^2$, $\\sum (x_i-\\bar x)^3=1485$ years$^3$ and $\\sum (x_i-\\bar x)^4=26983.5$ years$^4$.\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solution\na. $Q_1=53$ years, $Q_2=59$ years and $Q_3=68$ years.\na. There are 2 outliers: 25, 30.\n\n\n\n\n::: {.cell fig='true' hash='exam-2018-05-31_cache/epub/boxplot-ages_86192223410a7ded2c7540d0cea4f7fa'}\n\n```{.r .cell-code}\nboxplot(ages, horizontal=T, main=\"Boxplot of patients ages\")\n```\n\n::: {.cell-output-display}\n![](img/exam-2018-05-31/boxplot-ages-1.png)\n:::\n\n```{.r .cell-code}\n# require(ggplot2)\n# data <- data.frame(ages)\n# g <- ggplot(data, aes(x=\"\", y=ages)) + geom_boxplot() + \n#   labs(title=\"Boxplot of patients ages\", x=\"Patients\", y = \"Ages\") + \n#   coord_flip() + \n#   theme(plot.title = element_text(hjust = 0.5))\n# print(g)\n```\n:::\n\n\n\n\na. Let $x$ be the age in patients younger than 65 and $y$ the age in patients older than 65.  \n$\\bar x=52.9444$ years, $s_x^2=112.1636$ years$^2$, $s_x=10.5907$ years and $cv_x=0.2$.  \n$\\bar y=73.5$ years, $s_y^2=39$ years$^2$, $s_y=6.245$ years and $cv_y=0.085$.  \nThe mean is more representative in patients older than 65 since the coefficient of variation is smaller.\n\na. $g_{1x}=-1.4426$ and $g_{1y}=0.7621$, thus the distribution of ages of people younger than 65 is less symmetric.\n\na. The standard scores are $z_x(50)=-0.278$ and $z_y(72)=-0.2402$, thus 50 years is relative smaller in the group of people younger than 65.\n:::\n\n:::{#exr-2}\n\n\n\n::: {.cell hash='exam-2018-05-31_cache/epub/unnamed-chunk-3_04b92cad5b68aea8ce0c0fa85ef228e3'}\n\n:::\n\n\n\n\nThe table below shows the number of injuries of several teams during a league and the average warm-up time of its players. \n\n\n\n\n\n::: {.cell hash='exam-2018-05-31_cache/epub/unnamed-chunk-4_fa2e91e5e73ce1d37c47f477e87b4cad'}\n\n```{.r .cell-code}\nkable(table) %>% kable_styling()\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Warm-up time </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 35 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 21 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 25 </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 23 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Injuries </td>\n   <td style=\"text-align:right;\"> 42 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\na. Draw the scatter plot.\n\na. Which regression model is more suitable to predict the number of injuries as a function of the warm-up time, the logarithmic or the exponential? \nUse that regression model to predict the expected number of injuries for a team whose players warm-up 20 minutes a day.\n\na. Which regression model is more suitable to predict the warm-up time as a function of the number of injuries, the logarithmic or the exponential? \nUse that regression model to predict the warm-up time required to have no more than 10 injuries in a league.\n\na. Are these predictions reliable? Which one is more reliable?\n\nUse the following sums for the computations ($X$ warm-up time and $Y$ number of injuries):  \n$\\sum x_i=237$, $\\sum \\log(x_i)=31.3728$, $\\sum y_j=157$, $\\sum \\log(y_j)=24.0775$,    \n$\\sum x_i^2=5937$, $\\sum \\log(x_i)^2=98.9906$, $\\sum y_j^2=3843$, $\\sum \\log(y_j)^2=66.3721$,  \n$\\sum x_iy_j=3115$, $\\sum x_i\\log(y_j)=519.1907$, $\\sum \\log(x_i)y_j=465.8093$, $\\sum \\log(x_i)\\log(y_j)=73.3995$.\n:::\n\n:::{.callout-tip collapse=\"true\"}\n## Solution\n\na. \n\n\n\n\n::: {.cell hash='exam-2018-05-31_cache/epub/scatterplot-injuries-warm-up_a9c9c21825f2e0066885a4480950b96e'}\n\n```{.r .cell-code}\nplot(x, y, main=\"Scatter plot of warm-up time and injuries\", xlab = \"Warm-up time\", ylab=\"Injuries\")\n```\n\n::: {.cell-output-display}\n![](img/exam2018-05-31/scatterplot-injuries-warm-up-1.png)\n:::\n:::\n\n\n\n\na. $\\bar x=23.7$ min, $s_x^2=32.01$ min$^2$.  \n$\\overline{\\log(x)}=3.1373$ log(min), $s_{\\log(x)}^2=0.0565$ log(min)$^2$.  \n$\\bar y=15.7$ injuries, $s_y^2=137.81$ injuries$^2$.  \n$\\overline{\\log(y)}=2.4078$ log(injuries), $s_{\\log(y)}^2=0.8399$ log(injuries)$^2$.  \n$s_{x\\log(y)}=-5.1446$, $s_{\\log(x)y}=-2.6744$  \nExponential determination coefficient: $r^2=0.9844$  \nLogarithmic determination coefficient: $r^2=0.9185$  \nSo the exponential regression model es better to predict the number of injuries as a function of the warm-up time.  \nExponential regression model: $y=e^{6.2168+-0.1607x}$.  \nPrediction: $y(20)=20.1341$ injuries.\n\na. The logarithmic model is better to predict the warm-up time as a function of the number or injuries.  \nLogarithmic regression model: $x=164.1851+-47.3292\\log(y)$.  \nPrediction: $x(10)=55.2056112$ min.\n\na. Both predictions are very reliable since de deternation coefficient is very high but the last one is a little less reliable as it is for a value further from the data range.\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{},\"value\":[]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}